## ğŸ’¡ ë“¤ì–´ê°€ê¸°
- í•´ë‹¹ ì£¼ì œì— ëŒ€í•œ ì„ ì •ì´ìœ  (ìˆœìˆ˜í•˜ê²Œ ê¶ê¸ˆí•´ì„œ ì´ëŸ°ê²ƒë„ OK)
    - ì‹¤ìŠµí•  ë•Œ LaunchedEffectì™€ SideEffectê°€ ë‚˜ì™”ëŠ”ë° ë­ê°€ ë‹¤ë¥¸ê±´ì§€ ê¶ê¸ˆí•´ì„œ
- ì°¸ê³ ìë£Œ ë ˆí¼ëŸ°ìŠ¤
    
    https://developer.android.com/develop/ui/compose/side-effects?hl=ko
    
    https://medium.com/@mortitech/exploring-side-effects-in-compose-f2e8a8da946b
    
    https://heegs.tistory.com/162
    

</aside>

# Side Effect í•¨ìˆ˜ë“¤

### í•„ìš”ì„±

ì„±ëŠ¥ í–¥ìƒì˜ ê´€ì ì—ì„œ UIì—ì„œ ë°œìƒí•˜ëŠ” Effectë“¤ì„ ê´€ë¦¬í•˜ëŠ” ê²ƒì€ ì¤‘ìš”í•˜ë‹¤. 

UIì—ì„œ ë°œìƒí•˜ëŠ” Effectë¥¼ íš¨ìœ¨ì ìœ¼ë¡œ ê´€ë¦¬í•˜ëŠ” í•¨ìˆ˜ë¡œ SideEffect, LaunchedEffect, DisposableEffect ê°€ ìˆë‹¤.

### Side Effect

- Composable í•¨ìˆ˜ ë‚´ì—ì„œ, í•¨ìˆ˜ ì™¸ë¶€ì—ì„œ ê´€ë¦¬ë˜ëŠ” ìƒíƒœë“¤ì„ ì œì–´í•˜ê¸° ìœ„í•´ ì‚¬ìš©í•œë‹¤.
- Side EffectëŠ” ì„±ëŠ¥ í–¥ìƒê³¼ ìœ ì§€ë³´ìˆ˜ì˜ ê´€ì ì—ì„œ UI ë Œë”ë§ ë¡œì§ê³¼ ë°˜ë“œì‹œ ë¶„ë¦¬ë˜ì–´ì•¼ í•œë‹¤.
- Ex) ìŠ¤ë‚µë°” í‘œì‹œ, íŠ¹ì • ìƒíƒœ ì¡°ê±´ì— ë”°ë¼ ë‹¤ë¥¸ í™”ë©´ìœ¼ë¡œ ì´ë™í•˜ëŠ” ì¼íšŒì„± ì´ë²¤íŠ¸

### Side Effect ê´€ë ¨ í•¨ìˆ˜ë“¤ì„ ì‚¬ìš©í–ˆì„ ë•Œì˜ ì¥ì 

- **`ì„±ëŠ¥ í–¥ìƒ`**
    - UIì™€ ê´€ë ¨ ì—†ëŠ” ì—°ì‚°ë“¤ì€ Composable ì™¸ë¶€ì—ì„œ ì‹¤í–‰ì‹œì¼œ UI ë Œë”ë§ ì„±ëŠ¥ì„ ë³´ì¡´í•  ìˆ˜ ìˆë‹¤.
- **`ì½”ë“œ êµ¬ì„± ê°œì„ `**
    - UIì™€ ë¶„ë¦¬ì‹œí‚´ìœ¼ë¡œì¨ ì½”ë“œë¥¼ ê°€ë…ì„± ìˆê²Œ ìœ ì§€ë³´ìˆ˜í•  ìˆ˜ ìˆë‹¤.
- **`í”„ë¡œë•íŠ¸ í’ˆì§ˆ ê°œì„ `**
    - Side Effectë“¤ì€ ì´ë²¤íŠ¸ ë¡œê¹…ê³¼ ë°ì´í„° ìˆ˜ì§‘í•  ë•Œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. ì´ë¥¼ í†µí•´ ì‚¬ìš©ìë“¤ì˜ í–‰ë™ ì¶”ì , ì´ìŠˆ íŒŒì•…ì´ ì‰½ê²Œ ê°€ëŠ¥í•˜ë‹¤.



# LaunchedEffect

![alt text](images/cyj_3_1.png)

- keyê°’ì´ ë³€ê²½ë  ë•Œë§ˆë‹¤ ì´í•˜ block ì˜ì—­ì„ ë¹„ë™ê¸°ë¡œ ìˆ˜í–‰í•œë‹¤.

**`ë°©ì‹ 1`**

![alt text](images/cyj_3_2.png)

- keyê°’ì— Unitì„ ë„£ì–´ì„œ í•´ë‹¹ í•¨ìˆ˜ê°€ ë°˜ë“œì‹œ í•œë²ˆë§Œ í˜¸ì¶œë˜ë„ë¡ êµ¬í˜„í•œë‹¤.
- Compose ë‚´ë¶€ì— ì‘ì„±í•˜ëŠ” ê²½ìš°ì—ëŠ” í•´ë‹¹ UIê°€ ê·¸ë ¤ì§€ëŠ” ê²½ìš° ë°˜ë“œì‹œ ì „ì²´ì ìœ¼ë¡œ ë‹¤ì‹œ ìˆ˜í–‰ë˜ì§€ë§Œ, **LaunchedEffect ì•ˆì— ìˆëŠ” blockì€ recompositionì´ ë°œìƒí•´ë„ ë‹¤ì‹œ ìˆ˜í–‰ë˜ì§€ ì•ŠëŠ”ë‹¤.**

**`ë°©ì‹ 2`**

![alt text](images/cyj_3_3.png)

- snapshotFlow
    - ì§€ì •í•œ ë°ì´í„°ì— ëŒ€í•´ ê´€ì°°ì´ ê°€ëŠ¥í•˜ë„ë¡ flowë¥¼ ë§Œë“¤ê³ , ê´€ì°° ì¤‘ì¸ ë°ì´í„°ì˜ ë³€ê²½ì„ ê¸°ë¡í•œë‹¤.
- ìœ„ì˜ í•¨ìˆ˜ëŠ” compose í•¨ìˆ˜ê°€ ì‹¤í–‰ë  ë•Œ ìµœì´ˆ í•œ ë²ˆë§Œ í˜¸ì¶œì´ ë˜ëŠ”ë°, messageì˜ ë³€í™”ë¥¼ íƒì§€í•  ìˆ˜ ìˆëŠ” snapshotFlowë¥¼ ë§Œë“¤ê³ , messageê°€ ë³€ê²½ë  ë•Œë§ˆë‹¤ collect ì´í•˜ ë¶€ë¶„ì„ ì‹¤í–‰í•œë‹¤.

### ğŸ¤”Â ê·¸ë ‡ë‹¤ë©´ ë‹¤ìŒ ë‘˜ì˜ ì°¨ì´ì ì€ ë­˜ê¹Œ?

![alt text](images/cyj_3_4.png)

- messageê°€ ë³€ê²½ë  ë•Œë§ˆë‹¤ blockì„ ì‹¤í–‰í•œë‹¤.

![alt text](images/cyj_3_5.png)

- ìµœì´ˆ í•œë²ˆ ì‹¤í–‰ë  ë•Œ messageê°’ì„ ê´€ì°°í•˜ë„ë¡ í•˜ê³ , ë³€ê²½ë  ë•Œ blockì„ ì‹¤í–‰í•œë‹¤.

â†’ ë™ì‘ì€ ê°™ìœ¼ë‚˜ ë™ì‘ì„ ìˆ˜í–‰í•˜ê¸°ê¹Œì§€ì˜ ê³¼ì •ì´ ë‹¤ë¥´ë‹¤!



# DisposableEffect

![alt text](images/cyj_3_6.png)

- LaunchedEffectì™€ ë¹„ìŠ·í•˜ê²Œ ë³´ì´ì§€ë§Œ, block ëŒ€ì‹  effectë¡œ ë˜ì–´ ìˆëŠ” DisposableEffectScopeê°€ ì¡´ì¬í•œë‹¤.
- DisposableEffectResultê°€ onDisposeë¥¼ í¬í•¨í•˜ê³  ìˆê¸° ë•Œë¬¸ì— ë°˜ë“œì‹œ override í•´ì„œ ì‚¬ìš©í•´ì•¼ í•œë‹¤.

**`ë°©ì‹ 1` Unit**

![alt text](images/cyj_3_7.png)

- key ê°’ì´ ë³€í•  ë•Œë§ˆë‹¤ effect ì˜ì—­ì„ ë¹„ë™ê¸°ë¡œ ìˆ˜í–‰í•œë‹¤.
- ìµœì´ˆ í•œë²ˆ 1ë²ˆ ì˜ì—­ì„ ì‹¤í–‰í•˜ê³ , Composeë¥¼ ë– ë‚  ë•Œ 2ë²ˆ ì˜ì—­ì„ ì‹¤í–‰í•œë‹¤.

**`ë°©ì‹ 2` Unit X**

![alt text](images/cyj_3_8.png)

- message ê°’ì´ ë³€ê²½ë  ë•Œë§ˆë‹¤ DisposableEffectê°€ ë‹¤ì‹œ ì‹¤í–‰ëœë‹¤.
- ì‹¤í–‰ íë¦„
    - messageê°€ ì²˜ìŒ ì„¤ì •ë˜ë©´:
        - **`(3) ì‹¤í–‰`** â†’ ìƒˆë¡œìš´ íš¨ê³¼ ì‹¤í–‰
    - message ê°’ì´ ë³€ê²½ë  ë•Œë§ˆë‹¤:
        - **`(4) ì‹¤í–‰`** (onDispose) â†’ ê¸°ì¡´ íš¨ê³¼ ì •ë¦¬
        - **`(3) ì‹¤í–‰`** â†’ ìƒˆë¡œìš´ message ê°’ì„ ë°˜ì˜í•œ íš¨ê³¼ ì‹¤í–‰
    - Composableì´ í™”ë©´ì—ì„œ ì‚¬ë¼ì§€ë©´:
        - **`(4) ì‹¤í–‰`** (onDispose) â†’ ë§ˆì§€ë§‰ìœ¼ë¡œ ì‹¤í–‰ëœ íš¨ê³¼ ì •ë¦¬

---

### LaunchedEffectì™€ DisposableEffectëŠ” key ê°’ì— ë”°ë¼ì„œ ì´í•˜ í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•œë‹¤.

### ğŸ¤”Â *keyê°’ì„ ë– ë‚˜ì„œ í™”ë©´ì´ ë‹¤ì‹œ recomposition ë  ë•Œë§ˆë‹¤ í•¨ìˆ˜ë¥¼ ìˆ˜í–‰ì‹œí‚¤ë ¤ë©´?*



# SideEffect

![alt text](images/cyj_3_9.png)

![alt text](images/cyj_3_10.png)

â†’ recompositionì´ ì„±ê³µì ìœ¼ë¡œ ìˆ˜í–‰ëœë‹¤ë©´ effect ì˜ì—­ì´ ë°˜ë“œì‹œ í˜¸ì¶œëœë‹¤!



# ê° í•¨ìˆ˜ì˜ ì‚¬ìš© ì˜ˆì‹œ

### LaunchedEffect


> `ë¹„ë™ê¸°` UI ìŠ¤ë ˆë“œë¥¼ ë¸”ë½í•˜ì§€ ì•Šê³  ê¸´ ì‹œê°„ì˜ ì‘ì—…(ë„¤íŠ¸ì›Œí¬ í˜¸ì¶œ, ì• ë‹ˆë©”ì´ì…˜)ì„ ì²˜ë¦¬í•  ë•Œ ì‚¬ìš©**

</aside>

- ë„¤íŠ¸ì›Œí¬ì—ì„œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ” ê²½ìš°
    - ì½”ë“œ
        
        ```kotlin
        @Composable
        fun MyScreen(userId: String) {
            var userData by remember { mutableStateOf<User?>(null) }
        
            LaunchedEffect(userId) {
                userData = fetchUserData(userId) // ë„¤íŠ¸ì›Œí¬ ìš”ì²­ (Side-Effect)
            }
        
            Text(text = userData?.name ?: "Loading...")
        }
        ```
        
        â†’ recompositionì´ ë°œìƒí•´ë„, userIdê°€ ë°”ë€Œì§€ ì•Šìœ¼ë©´ ë„¤íŠ¸ì›Œí¬ ìš”ì²­ì„ í•˜ì§€ ì•ŠëŠ”ë‹¤.
        
- ì´ë¯¸ì§€/ì˜ìƒ ì²˜ë¦¬
- DB ì—…ë°ì´íŠ¸

### DisposableEffect

<aside>

**Composableí•¨ìˆ˜ê°€ UIì—ì„œ ì œê±°ë  ë•Œ ì‹¤í–‰ë˜ì§€ ì•Šì•„ì•¼ í•˜ëŠ” ë¡œì§ì„ ìˆ˜í–‰í•  ë•Œ ì‚¬ìš©**

```kotlin
onDispose {
	job.cancel
}
```

**â†’ coroutineì„ ì·¨ì†Œí•˜ì—¬ ë¦¬ì†ŒìŠ¤ ê´€ë¦¬ë¥¼ ë³´ì¥í•œë‹¤.**

</aside>

- ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë¶€ì°©/íƒˆì°©
- ì• ë‹ˆë©”ì´ì…˜ ì‹œì‘/ì¤‘ì§€

### SideEffect

- ì´ë²¤íŠ¸ ë¡œê¹…/ë°ì´í„° ìˆ˜ì§‘
- ë¸”ë£¨íˆ¬ìŠ¤ ê¸°ê¸° ì—°ê²°, íŒŒì¼ ë°ì´í„° ë¡œë“œ, ë¼ì´ë¸ŒëŸ¬ë¦¬ ì´ˆê¸°í™” ê°™ì€ ì¼íšŒì„± ì´ˆê¸°í™” ë¡œì§ ì‹¤í–‰
    - ì½”ë“œ
        
        ```kotlin
        @Composable
        fun MyComposable() {
            val isInitialized = remember { mutableStateOf(false) }
        
            SideEffect {
                if (!isInitialized.value) {
                    // í•œë²ˆë§Œ ì‹¤í–‰í•´ì•¼ í•˜ëŠ” ë¡œì§ì„ ë„£ëŠ”ë‹¤
                    initializeBluetooth()
                    loadDataFromFile()
                    initializeLibrary()
                    
                    isInitialized.value = true
                }
            }
        
            // UI ê´€ë ¨ ì½”ë“œ
        }
        ```